# Motion Tracker Android App

Android приложение для детекции движения с поддержкой OTG устройств.

## Описание

Это Android приложение, созданное на основе оригинального Python трекера движения. Оно адаптировано для работы на мобильных устройствах Android с поддержкой:

- Детекция движения в реальном времени
- Подключение ESP32 через USB OTG
- Работа с USB камерами
- Современный пользовательский интерфейс

## Структура проекта

```
android_motion_tracker/
├── main.py                 # Главный файл приложения
├── buildozer.spec         # Конфигурация для сборки APK
├── requirements.txt       # Python зависимости
├── src/
│   ├── core/
│   │   ├── motion_tracker.py    # Логика детекции движения
│   │   └── otg_manager.py       # Управление OTG устройствами
│   └── ui/
│       └── main_screen.py       # Пользовательский интерфейс
├── assets/
│   ├── images/            # Изображения
│   └── sounds/            # Звуки
└── docs/                  # Документация
```

## Установка и настройка

### 1. Установка зависимостей

```bash
# Установка Python зависимостей
pip install -r requirements.txt

# Установка Buildozer
pip install buildozer

# Установка Android SDK (требуется для сборки)
# Следуйте инструкциям на https://buildozer.readthedocs.io/
```

### 2. Настройка Android SDK

1. Скачайте Android SDK
2. Установите переменные окружения:
   ```bash
   export ANDROIDSDK="/path/to/android-sdk"
   export ANDROIDNDK="/path/to/android-ndk"
   export ANDROIDAPI="33"  # API level
   export NDKAPI="21"      # NDK API level
   ```

### 3. Первая сборка

```bash
# Инициализация проекта (создает .buildozer папку)
buildozer init

# Сборка debug версии
buildozer android debug

# Сборка release версии
buildozer android release
```

## Использование

### Запуск приложения

1. Установите APK файл на Android устройство
2. Предоставьте необходимые разрешения:
   - Камера
   - USB устройства
   - Хранилище

### Подключение OTG устройств

1. Подключите USB OTG адаптер к устройству
2. Подключите ESP32 или USB камеру
3. Приложение автоматически обнаружит устройство
4. Нажмите кнопку "OTG" для управления устройствами

### Настройка детекции движения

- **Чувствительность**: Используйте слайдер для настройки
- **Минимальная площадь**: Настройте в панели настроек
- **Алгоритм**: Выберите алгоритм детекции (MOG2, KNN)

## Разработка

### Тестирование на эмуляторе

```bash
# Запуск эмулятора
emulator -avd your_avd_name

# Установка APK
adb install bin/motiontracker-1.0.0-debug.apk
```

### Отладка

```bash
# Просмотр логов
adb logcat | grep python

# Подключение к устройству
adb devices
```

### Изменение конфигурации

Отредактируйте `buildozer.spec` для изменения:
- Названия приложения
- Разрешений
- Зависимостей
- Настроек сборки

## Поддерживаемые устройства

### ESP32
- CP2102 USB to UART Bridge
- CH340 USB to UART Bridge
- Другие совместимые чипы

### USB Камеры
- Logitech Webcams
- Realtek USB Cameras
- UVC совместимые камеры

## Ограничения

- Требуется Android 5.0+ (API 21+)
- USB OTG поддержка на устройстве
- Достаточная производительность для обработки видео

## Устранение неполадок

### Проблемы со сборкой

1. **Ошибки NDK**: Обновите NDK до последней версии
2. **Проблемы с разрешениями**: Проверьте настройки в buildozer.spec
3. **Большой размер APK**: Используйте proguard для оптимизации

### Проблемы с OTG

1. **Устройство не обнаружено**: Проверьте совместимость
2. **Ошибки подключения**: Убедитесь в правильности драйверов
3. **Медленная работа**: Проверьте производительность устройства

## Лицензия

Этот проект основан на оригинальном Motion Tracker и адаптирован для Android.

## Поддержка

Для получения помощи:
1. Проверьте документацию
2. Изучите логи приложения
3. Создайте issue в репозитории проекта